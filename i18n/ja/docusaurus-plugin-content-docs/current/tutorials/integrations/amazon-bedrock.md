---
sidebar_position: 31
title: "ğŸ›Œ Integrate with Amazon Bedrock"
---

:::warning
ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã‚‹å¯„ç¨¿ã§ã‚ã‚Šã€Sage Open WebUIãƒãƒ¼ãƒ ã«ã‚ˆã£ã¦ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å‘ã‘ã«Sage Open WebUIã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹æ–¹æ³•ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚å¯„ç¨¿ã‚’ã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ å¯„ç¨¿ã‚¬ã‚¤ãƒ‰ã‚’ã”ç¢ºèªãã ã•ã„ã€‚
:::

---

# Sage Open WebUIã¨Amazon Bedrockã®çµ±åˆ

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€sage-open-webuiã¨Amazon Bedrockã‚’çµ±åˆã™ã‚‹æœ€ã‚‚ä¸€èˆ¬çš„ã§äººæ°—ã®ã‚ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®1ã¤ã‚’æ¢ã‚Šã¾ã™ã€‚

## å‰ææ¡ä»¶

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’é€²ã‚ã‚‹ã«ã¯ã€ä»¥ä¸‹ãŒå¿…è¦ã§ã™ï¼š

- æœ‰åŠ¹ãªAWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆ
- æœ‰åŠ¹ãªAWSã‚¢ã‚¯ã‚»ã‚¹ã‚­ãƒ¼ã¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼
- AWSã§Bedrockãƒ¢ãƒ‡ãƒ«ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹IAMæ¨©é™ã€ã¾ãŸã¯æ—¢ã«æœ‰åŠ¹åŒ–ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«
- ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸDocker

## Amazon Bedrockã¨ã¯

AWSã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚ˆã‚Šç›´æ¥å¼•ç”¨ï¼š

ã€ŒAmazon Bedrockã¯ã€AI21 Labsã€Anthropicã€Cohereã€Lumaã€Metaã€Mistral AIã€poolsideï¼ˆè¿‘æ—¥å…¬é–‹äºˆå®šï¼‰ã€Stability AIã€Amazonãªã©ã®ä¸»è¦AIä¼æ¥­ã®é«˜æ€§èƒ½åŸºç›¤ãƒ¢ãƒ‡ãƒ«ï¼ˆFMï¼‰ã‚’å˜ä¸€ã®APIã‹ã‚‰é¸æŠã§ãã‚‹å®Œå…¨ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã€è²¬ä»»ã‚ã‚‹AIã‚’å‚™ãˆãŸç”ŸæˆAIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«å¿…è¦ãªå¹…åºƒã„æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚Amazon Bedrockã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«æœ€é©ãªãƒˆãƒƒãƒ—FMã‚’ç°¡å˜ã«è©¦ã—ã¦è©•ä¾¡ã—ã€ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚„Retrieval Augmented Generationï¼ˆRAGï¼‰ãªã©ã®æŠ€è¡“ã§ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦éå…¬é–‹ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã€ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚·ã‚¹ãƒ†ãƒ ã¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚Amazon Bedrockã¯ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§ã‚ã‚‹ãŸã‚ã€ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ãŒãªãã€æ—¢ã«æ…£ã‚Œè¦ªã—ã‚“ã§ã„ã‚‹AWSã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ç”ŸæˆAIæ©Ÿèƒ½ã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å®‰å…¨ã«çµ±åˆãŠã‚ˆã³å±•é–‹ã§ãã¾ã™ã€‚ã€

Bedrockã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€[Amazon Bedrockå…¬å¼ãƒšãƒ¼ã‚¸](https://aws.amazon.com/bedrock/)ã‚’ã”è¦§ãã ã•ã„ã€‚

# çµ±åˆæ‰‹é †

## ã‚¹ãƒ†ãƒƒãƒ—1: Amazon Bedrockãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¢ºèª

Bedrockã¨çµ±åˆã™ã‚‹å‰ã«ã€ã¾ãšåˆ©ç”¨å¯èƒ½ãªãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã®ã†ã¡å°‘ãªãã¨ã‚‚1ã¤ï¼ˆã§ãã‚Œã°è¤‡æ•°ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®è¨˜äº‹ã®åŸ·ç­†æ™‚ç‚¹ï¼ˆ2025å¹´2æœˆï¼‰ã§ã¯ã€47ã®ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ãŒåˆ©ç”¨å¯èƒ½ã§ã—ãŸã€‚ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã§ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ç§ã¯è¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ãƒ¢ãƒ‡ãƒ«æ¨ªã«ã€Œâœ… ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯æ¸ˆã¿ã€ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°ã€ãã®ãƒ¢ãƒ‡ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ã©ã®ãƒ¢ãƒ‡ãƒ«ã«ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

AWSã¯ã€ã“ã‚Œã‚‰ã®ãƒ¢ãƒ‡ãƒ«ã®ã‚¢ã‚¯ã‚»ã‚¹è¦æ±‚/æœ‰åŠ¹åŒ–ã«é–¢ã™ã‚‹å„ªã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æä¾›ã—ã¦ã„ã¾ã™ï¼š[Amazon Bedrockãƒ¢ãƒ‡ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.aws.amazon.com/bedrock/latest/userguide/model-access-modify.html)

![Amazon Bedrockãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«](/images/tutorials/amazon-bedrock/amazon-bedrock-base-models.png)

## ã‚¹ãƒ†ãƒƒãƒ—2: Bedrock Access Gatewayã®è¨­å®š

å°‘ãªãã¨ã‚‚1ã¤ã®Bedrockãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€Bedrock Access Gatewayï¼ˆBAGï¼‰ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚BAGã¯ã€AWSãŒé–‹ç™ºã—ãŸãƒ—ãƒ­ã‚­ã‚·ã¾ãŸã¯ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¨è€ƒãˆã‚‹ã“ã¨ãŒã§ãã€Bedrockã®AWSãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ/SDKã‚’ãƒ©ãƒƒãƒ—ã—ã€sage-open-webuiãŒè¦æ±‚ã™ã‚‹OpenAIã®ã‚¹ã‚­ãƒ¼ãƒã¨äº’æ›æ€§ã®ã‚ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å…¬é–‹ã—ã¾ã™ã€‚

å‚è€ƒã¾ã§ã«ã€ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆé–“ã®ç°¡å˜ãªãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š

| OpenAI Endpoint       | Bedrock Method         |
|-----------------------|------------------------|
| `/models`               | list_inference_profiles    |
| `/models/{model_id}`    | list_inference_profiles    |
| `/chat/completions`     | converse or converse_stream    |
| `/embeddings`           | invoke_model           |

BAGãƒªãƒã‚¸ãƒˆãƒªã¯ã“ã¡ã‚‰ï¼š[Bedrock Access Gatewayãƒªãƒã‚¸ãƒˆãƒª](https://github.com/aws-samples/bedrock-access-gateway)

BAGã‚’è¨­å®šã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ï¼š

- BAGãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®`dockerfile`ã‚’å‰Šé™¤
- `Dockerfile_ecs`ã®åå‰ã‚’`Dockerfile`ã«å¤‰æ›´

ã“ã‚Œã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ“ãƒ«ãƒ‰ãŠã‚ˆã³èµ·å‹•ã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸï¼š

```bash
docker build . -f Dockerfile -t bedrock-gateway

docker run -e AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID -e AWS_SECRET_ACCESS_KEY="$AWS_SECRET_ACCESS_KEY" -e AWS_REGION=us-east-1 -d -p 8000:80 bedrock-gateway
```

ã“ã‚Œã§BAGã®Swaggerãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™: http://localhost:8000/docs

![Bedrock Access Gateway Swagger](/images/tutorials/amazon-bedrock/amazon-bedrock-proxy-api.png)

## ã‚¹ãƒ†ãƒƒãƒ—3: sage-open-webuiã«æ¥ç¶šã‚’è¿½åŠ 

BAGãŒèµ·å‹•ãƒ»å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã®ã§ã€æ¬¡ã¯sage-open-webuiã«æ–°ã—ã„æ¥ç¶šã¨ã—ã¦è¿½åŠ ã—ã¾ã™ã€‚

- ç®¡ç†è€…ãƒ‘ãƒãƒ«ã§ã€è¨­å®š -> æ¥ç¶š ã«ç§»å‹•ã—ã¾ã™
- "+"ï¼ˆãƒ—ãƒ©ã‚¹ï¼‰ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦OpenAIã®ä¸‹ã«æ–°ã—ã„æ¥ç¶šã‚’è¿½åŠ ã—ã¾ã™
- URLã«ã¯ã€Œhttp://host.docker.internal:8000/api/v1ã€ã‚’ä½¿ç”¨ã—ã¾ã™
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«ã¯ã€BAGã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã€Œbedrockã€ã‚’ä½¿ç”¨ã—ã¾ã™ï¼ˆDEFAULT_API_KEYSã§ã“ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¤‰æ›´å¯èƒ½ã§ã™ï¼‰
- ã€Œæ¥ç¶šã‚’ç¢ºèªã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å³ä¸Šã«ã€Œã‚µãƒ¼ãƒãƒ¼æ¥ç¶šãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€ã¨ã„ã†ã‚¢ãƒ©ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™

![Add New Connection](/images/tutorials/amazon-bedrock/amazon-bedrock-proxy-connection.png)

## ã‚¹ãƒ†ãƒƒãƒ—4: Bedrockãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã®ä½¿ç”¨ã‚’é–‹å§‹

ã“ã‚Œã§ã€ã™ã¹ã¦ã®Bedrockãƒ¢ãƒ‡ãƒ«ãŒåˆ©ç”¨å¯èƒ½ã«ãªã£ã¦ã„ã‚‹ã¯ãšã§ã™ï¼

![Use Bedrock Models](/images/tutorials/amazon-bedrock/amazon-bedrock-models-in-oui.png)

## ãã®ä»–ã®å½¹ç«‹ã¤ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

sage-open-webuiã‚’Amazon Bedrockã¨çµ±åˆã™ã‚‹éš›ã«å½¹ç«‹ã¤ä»–ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ã¾ã™ã€‚

- https://gauravve.medium.com/connecting-sage-open-webui-to-aws-bedrock-a1f0082c8cb2
- https://jrpospos.blog/posts/2024/08/using-amazon-bedrock-with-openwebui-when-working-with-sensitive-data/