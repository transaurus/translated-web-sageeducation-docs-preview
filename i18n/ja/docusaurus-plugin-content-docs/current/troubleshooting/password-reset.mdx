---
sidebar_position: 1
title: "🔑 Reset Admin Password"
---

# 管理者パスワードのリセット 🗝️

管理者パスワードを忘れてしまっても心配ありません！以下に、Sage WebUIのDocker 🐳 デプロイメントおよびローカルインストール向けの管理者パスワードリセット手順をステップバイステップでご紹介します。

## Dockerデプロイメント向け 🐳

Dockerを使用してデプロイされたSage WebUIの管理者パスワードをリセットするには、以下の手順に従ってください。

### ステップ1: 新しいパスワードハッシュの生成 🔐

まず、新しいパスワードのbcryptハッシュを作成する必要があります。ローカルマシンで以下のコマンドを実行し、`your-new-password`を希望のパスワードに置き換えてください：

```bash
htpasswd -bnBC 10 "" your-new-password | tr -d ':\n'
```

**注:** 出力には特殊文字を含むbcryptハッシュが含まれます。ハッシュ内の`$`文字は、次のステップで正しく使用するために三重にエスケープ（`\\\`に置換）する必要があります。

### ステップ2: Docker内のパスワードを更新 🔄

次に、Dockerデプロイメント内のパスワードを更新します。以下のコマンドの`HASH`をステップ1で生成したbcryptハッシュに置き換え、`$`文字を三重にエスケープしてください。また、`admin@example.com`を管理者アカウントに関連付けられたメールアドレスに置き換えます。

**重要:** 以下のコマンドがすべての場合に機能するとは限りません。うまくいかない場合は、下記の代替コマンドをお試しください。

```bash
docker run --rm -v sage-open-webui:/data alpine/socat EXEC:"bash -c 'apk add sqlite && echo UPDATE auth SET password='\''HASH'\'' WHERE email='\''admin@example.com'\''; | sqlite3 /data/webui.db'", STDIO
```

## ローカルインストール向け 💻

Sage WebUIをローカルにインストールしている場合、システム上で直接管理者パスワードをリセットする方法は以下の通りです。

### ステップ1: 新しいパスワードハッシュの生成 🔐

Dockerの方法と同様に、まず新しいパスワードのbcryptハッシュを生成します。以下のコマンドを使用し、`your-new-password`を新しいパスワードに置き換えてください：

```bash
htpasswd -bnBC 10 "" your-new-password | tr -d ':\n'
```

### ステップ2: ローカルでパスワードを更新 🔄

次に、ローカルマシンの`sage-open-webui`ディレクトリに移動します。ステップ1で生成したbcryptハッシュで`HASH`を置き換え、`admin@example.com`を管理者アカウントのメールアドレスに置き換えて、以下のコマンドを実行します：

```bash
sqlite3 backend/data/webui.db "UPDATE auth SET password='HASH' WHERE email='admin@example.com';"
```

#### Dockerの代替方法

_上記の方法で問題が発生した場合。_ `alpine/socat`で`bash`コマンドを連結する際に問題が発生しました（`bash`が存在しないため）。

1. **`sage-open-webui`ボリュームに接続された`alpine` Linuxを実行します。**

    ```bash
    docker run -it --rm -v sage-open-webui:/path/to/data alpine
    ```
    _`/path/to/data`は__あなたの__ボリューム設定に依存します。_

    1. `apache2-utils`と`sqlite`をインストール：

        ```sh
        apk add apache2-utils sqlite
        ```
    1. `bcrypt`ハッシュを生成：

        ```sh
        htpasswd -bnBC 10 "" your-new-password | tr -d ':'
        ```

    1. パスワードを更新：

        ```sh
        sqlite3 /path/to/data/webui.db
        ```

        ```sql
        UPDATE auth SET password='HASH' WHERE email='admin@example.com';
        -- sqliteを終了: [Ctrl + d]
        ```

## データの完全リセット

Sage Open WebUIを**完全にリセット**したい場合（すべてのユーザーデータ、設定、パスワードを含む）、`webui.db`ファイルを削除するには以下の手順に従ってください。

### ステップ1: Python環境内で`webui.db`を探す

`webui.db`の場所がわからない場合（特に仮想環境を使用している場合）、以下の手順に従って確認できます：

1. 仮想環境を有効化します（該当する場合）。
2. Pythonシェルを開きます：
   python

3. Pythonシェル内で以下のコードを実行します：

```
   import os
   import open_webui

   # Show where the Sage Open WebUI package is installed
   print("Sage Open WebUI is installed at:", open_webui.__file__)

   # Construct a potential path to webui.db (commonly located in 'data/webui.db')
   db_path = os.path.join(os.path.dirname(open_webui.__file__), "data", "webui.db")
   print("Potential path to webui.db:", db_path)

   # Check if webui.db exists at that path
   if os.path.exists(db_path):
       print("webui.db found at:", db_path)
   else:
       print("webui.db not found at:", db_path)
```

4. 出力を確認します：
   - ファイルが見つかった場合、その正確なパスが表示されます。
   - 見つからない場合は、より広範なファイルシステム検索（例：Linuxでは`find`、Windows/Macではグローバルファイル検索）が必要になる場合があります。

### ステップ2: `webui.db`の削除

ファイルの場所を特定したら、以下のようなコマンドで削除します：

```
   rm -rf /path/to/your/python/environment/lib/pythonX.X/site-packages/open_webui/data/webui.db
```

**警告:** `webui.db`を削除すると、ユーザーアカウント、設定、パスワードを含むすべての保存データが消去されます。完全に初期状態からやり直したい場合のみ実行してください！

📖 これらの簡単な手順に従えば、すぐにSage Open WebUIの管理者アカウントにアクセスできるようになります。処理中に問題が発生した場合は、フォーラムやコミュニティプラットフォームで解決策を探すことを検討してください。